# Sprint Change Proposal: Hosting Infrastructure Migration

**Date:** 6 December 2025
**Author:** MG (via Correct Course Workflow)
**Status:** Proposed

---

## 1. Issue Summary

**Trigger:** Strategic decision to migrate hosting infrastructure from Vercel to a self-hosted Coolify instance on Hetzner Cloud.
**Context:** The project now utilizes a `Dockerfile` for containerized builds. Deployment is managed automatically by the Coolify GitHub App, which listens for push events. This renders the previous Vercel-specific deployment pipeline and configuration obsolete.
**Goal:** Align project documentation and sprint plans with the new infrastructure reality, ensuring the CI pipeline focuses on code quality verification rather than deployment orchestration.

## 2. Impact Analysis

### Epic Impact
*   **Epic 1 (Foundation & Infrastructure):**
    *   **Story 1.8:** "Deployment Pipeline & Vercel Configuration" is no longer accurate.
    *   **Impact:** High. The story requires rewriting to focus on "CI Pipeline & Quality Checks" (Linting, Testing, Type-checking, Docker Build verification).

### Artifact Conflicts
*   **Architecture Document (`docs/architecture.md`):**
    *   **Platform Stack:** "Hosting" and "CDN" entries referenced Vercel.
    *   **Configuration:** "Vercel Configuration" section was present.
    *   **Impact:** High. Required updates to reflect Hetzner/Coolify stack and Docker-based build method.
*   **Epics Document (`docs/epics.md`):**
    *   **Story 1.8:** Contained Vercel-specific acceptance criteria (`vercel.json`, region config).
    *   **Impact:** High. Acceptance criteria needed complete revision.

### Technical Impact
*   **CI/CD:** The GitHub Actions workflow (`.github/workflows/ci.yml`) no longer needs to handle deployment steps. It must now verify that the `Dockerfile` builds correctly to ensure Coolify can deploy successfully.
*   **Configuration:** `vercel.json` is no longer required.

## 3. Recommended Approach

**Selected Path:** **Direct Adjustment**

**Rationale:**
This is a straightforward infrastructure swap that does not fundamentally alter the product's functional requirements or user experience. Modifying the existing documentation and story definitions is the most efficient path. It avoids the overhead of creating new epics or rolling back work, as the core application logic remains unchanged.

**Risk Level:** Low. The change is isolated to the infrastructure and deployment layer.

## 4. Detailed Change Proposals

The following changes have been applied to the project documentation:

### A. Architecture Document (`docs/architecture.md`)
*   **Hosting Provider:** Updated from "Vercel" to "Hetzner (via Coolify)".
*   **Deployment Config:** Replaced `vercel.json` section with "Coolify Configuration" detailing the Docker/GitHub App setup.
*   **CDN:** Updated to "Coolify/Nginx".

### B. Epics Document (`docs/epics.md`)
*   **Story 1.8 Renamed:** Changed from "Deployment Pipeline & Vercel Configuration" to "**CI Pipeline & Quality Checks**".
*   **Acceptance Criteria Updated:**
    *   Removed all Vercel references.
    *   Added requirement for **Docker build verification** in CI.
    *   Clarified that deployment is handled externally by Coolify.

## 5. Implementation Handoff

**Scope Classification:** **Minor**
*   The changes are well-defined and isolated to configuration and documentation.

**Route To:** **Development Team / DevOps**

**Deliverables:**
1.  **Updated Documentation:** `docs/architecture.md` and `docs/epics.md` (Completed).
2.  **CI Workflow Update:** Developers must update `.github/workflows/ci.yml` to:
    *   Remove any Vercel deployment steps.
    *   Add a step to verify `docker build .`
3.  **Environment Setup:** Ensure `DATABASE_URL` and other secrets are correctly configured in the Coolify dashboard.

**Success Criteria:**
*   CI pipeline passes on PRs (Lint, Test, Type-check, Docker Build).
*   Coolify successfully deploys the application upon merge to `main`.
*   Application is accessible via the configured domain on Hetzner.

---
*Generated by BMAD Correct Course Workflow*
